2022년 4월 18일 월요일


# AOP: 백엔드 개발 필수

- 내부 클래스
    - 클래스 내부에 선언한 클래스로 이 클래스를 감싸고 있는 외부 클래스와 밀접한 연관이 있는 경우가 많고,  다른 외부 클래스에서 사용할 일이 거의 없는 경우에 내부 클래스로 선언해서 사용함
    - 중첩 클래스라고도 함
    - 인스턴스 내부 클래스
        - 내부적으로 사용할 클래스를 선언 (private으로 선언하는 것을 권장)
        - 외부 클래스가 생성된 후 생성됨 ( 정적 내부 클래스와 다름 )
        - private이 아닌 내부 클래스는 다른 외부 클래스에서 생성할 수 있음
    - 정적 내부 클래스
        - 외부 클래스 생성과 무관하게 사용할 수 있음
        - 정적 변수, 정적 메서드 사용
        - 정적 내부 클래스 일반 메서드와 정적 메서드에서의 변수 사용
    - 지역 내부 클래스
        - 지역 변수와 같이 메서드 내부에서 정의하여 사용하는 클래스
        - 메서드의 호출이 끝나면 메서드에 사용된 지역변수의 유효성은 사라짐
        - 메서드 호출 이후에도 사용해야 하는 경우가 있을 수 있으므로 지역 내부 클래스에서 사용하는 메서드의 지역 변수나 매개 변수는 final로 선언됨
    - 익명 내부 클래스
        - 이름이 없는 클래스 (위 지역 내부 클래스의 MyRunnable 클래스 이름은 실제로 호출되는 경우가 없음)
        - 클래스의 이름을 생략하고 주로 하나의 인터페이스나 하나의 추상 클래스를 구현하여 반환
        - 인터페이스나 추상 클래스 자료형의 변수에 직접 대입하여 클래스를 생성하거나 지역 내부 클래스의 메서드 내부에서 생성하여 반환 할 수 있음.
        - widget의 이벤트 핸들러에 활용됨

- 람다식(Lambda expression)
    - 함수의 구현과 호출만으로 프로그래밍이 수행되는 방식
    - 함수형 프로그래밍
    - 람다식을 선언하기 위한 인터페이스
    - 익명 함수와 매개 변수만으로 구현되므로 인터페이스는 단 하나의 메서드만을 선언해야함
    - @FunctionalInterface 애노테이션(annotation)
    - 자바에서는 객체 없이 메서드가 호출 될 수 없음
    - 람다식을 구현하면 익명 내부 클래스가 만들어지고, 이를 통해 익명 객체가 생성됨
    - 익명 내부 클래스에서와 마찬가지로 람다식 내부에서 에서도 외부에 있는 지역 변수의 값을 변경하면 오류가 발생함

- 스트림(Stream)
    - 자료의 대상과 관계없이 동일한 연산을 수행
    - 배열, 컬렉션을 대상으로 연산을 수행 함
    - 일관성 있는 연산으로 자료의 처리를 쉽고 간단하게 함
    - 자료 처리에 대한 추상화가 구현되었다고 함
    - 한번 생성하고 사용한 스트림은 재사용 할 수 없음
    - 자료에 대한 스트림을 생성하여 연산을 수행하면 스트림은 소모됨
    - 다른 연산을 수행하기 위해서는 스트림을 다시 생성해야 함
    - 스트림 연산은 기존 자료를 변경하지 않음
    - 자료에 대한 스트림을 생성하면 스트림이 사용하는 메모리 공간은 별도로 생성되므로 연산이 수행되도 기존 자료에 대한 변경은 발생하지 않음
    - 스트림 연산은 중간 연산과 최종 연산으로 구분 됨
    - 스트림에 대해 중간 연산은 여러 개의 연산이 적용될 수 있지만 최종 연산은 마지막에 한 번만 적용됨
    - 최종연산이 호출되어야 중간 연산에 대한 수행이 이루어 지고 그 결과가 만들어짐
    - 중간 연산에 대한 결과를 연산 중에 알수 없음
    - 지연 연산
    - 중간 연산과 최종 연산에 대한 구현은 람다식을 활용함
    - reduce() (배열의 모든 요소의 합)

- 예외 처리
    - 컴파일 오류(compile error)
        - 프로그램 코드 작성 중 발생하는 문법적 오류
        - 최근에는 개발 환경(eclipse)에서 대부분의 컴파일 오류는 detection 됨
    - 실행 오류(runtime error)
        - 실행 중인 프로그램이 의도 하지 않은 동작(bug)을 하거나 프로그램이 중지 되는 오류
        - 실행 오류는 비정상 종료가 되는 경우 시스템의 심각한 장애를 발생할 수 있음

    - 프로그램의 비정상 종료를 피하여 시스템이 원할이 실행되도록 함
    - 실행 오류가 발생한 경우 오류의 과정을 재현하는 것은 현실적으로 힘들다
    - 오류가 발생한 경우 log를 남겨서 추후 log 분석을 통해 그 원인을 파악하여 bug를 수정하는 것이 중요
    - 시스템 오류(error) : 가상 머신에서 발생, 프로그래머가 처리 할 수 없는 오류임
    동적 메모리가 없는 경우, 스택 메모리 오버플로우등
    - 예외(Exception) :프로그램에서 제어 할 수 있는 오류
    읽어들이려는 파일이 존재하지 않거나, 네트웍이나 DB연결이 안되는 경우등
    - 자바는 안전성이 중요한 언어로 대부분 프로그램에서 발생하는 오류에 대해 문법적으로 예외 처리를 해야함
    - 모든 예외 클래스의 최상위 클래스는 Exception 클래스
    - 자바에서는 다양한 예외들에 대해 그 처리를 위한 클래스가 제공되고 있음

    - Arithmetic Exception : 정수를 0 으로 나눈 경우 발생
    - NullPointerException : 초기화 되지 않은 Object를 사용하는 경우
    - ArrayIndexOutOfBoundsException : 배열의 크기를 넘어선 위치를 참조하려는 경우
    - FileNotFoundException : 참조하는 파일이 지정된 위치에 존재하지 않는 경우

    - try-catch
        - try 블록에는 예외가 발생할 가능성이 있는 코드를 작성하고 try 블록 안에서 예외가 발생하믄 경우 catch 블록이 수행됨
    - try-catch-finally
        - nally 블럭에서 파일를 닫거나 네트웍을 닫는 등의 리소스 해제 구현을 함
        - try{} 블럭이 수행되는 경우, finally{} 블럭은 항상 수행 됨
        - 여러 개의 예외 블럭이 있는 경우 각각에서 리소스를 해제하지 않고 finally 블록에서 해제하도록 구현함
        - 컴파일러에 의해 예외가 처리 되는 예 (파일 에러 처리)
    - try-with-resources
        - 리소스를 사용하는 경우 close() 하지 않아도 자동으로 해제 되도록 함
        - 자바 7부터 제공되는 구문
        - 리소스를 try() 내부에서 선언해야만 함
        - close()를 명시적으로 호출하지 않아도 try{}블록에서 열린 리소스는 정상적인 경우나 예외가 발생한 경우 모두 자동으로 해제됨
        - 해당 리소스 클래스가 AutoCloseable 인터페이스를 구현 해야 함
        - FileInputStream의 경우에는 AutoCloseable을 구현하고 있음
        - 자바 9 부터 리소스는 try() 외부에서 선언하고 변수만을 try(obj) 와 같이 사용할 수 있음

    - throws를 이용하면 예외가 발생할 수 있는 부분을 사용하는 문장에서 예외를 처리할 수 있음
    - 여러개의 예외가 발생하는 경우 예외를 묶어서 하나의 방법으로 처리할 수도 있고, 각각의 예외를 따로 처리할 수도 있음
    - Exception 클래스를 활용하여 defualt 처리를 할 때 Exception 블록은 맨 마지막에 위치해야 함
    - 사용자 정의 예외 클래스
        - 자바에서 제공되는 예외 클래스외에 프로그래머가 직접 만들어야 하는 예외가 있을 수 있음
        - 기존 예외 클래스중 가장 유사한 예외 클래스에서 상속 받아 사용자 정의 예외 클래스를 만든다.
        - 기본적으로 Exception 클래스를 상속해서 만들 수 있음

    - logging
        - 시스템 운영에 대한 기록
        - 오류가 발생 했을 때 그 오류에 대한 기록을 남겨 디버깅을 용이하게 함
        - 로그 파일에 기록하는 코드를 추가하여 필요한 정보가 로그로 남을 수 있도록 한다
        - 디버깅, 시스템 에러 추적, 성능, 문제점 향상들을 위해 사용
        - 너무 적은 로그 : 정확한 시스템의 상황을 파악하기 어려움
        - 너무 많은 로그 : 빈번한 file I/O의 오버헤드와 로그 파일의 백업 문제 등
        - java.util.logging
            - 자바에서 기본적으로 제공되는 log package
            - 파일이나 콘솔에 로그 내용을 출력할 수 있음
            - jre/lib/logging.properties 파일을 편집하여 로그의 출력방식 로그 레벨을 변경 할 수 있음
            - logging 패키지에서 제공하는 로그 레벨은 severe, warning, info, config, fine, finer, finest 임
            - 오픈소스로는 log4j를 많이 사용하고 있음

- 입출력 스트림
    - 네트워크에서 자료의 흐름이 물의 흐름과 같다는 비유에서 유래됨
    - 자바는 다양한 입출력 장치에 독립적으로 일관성있는 입출력을 입출력 스트림을 통해 제공
    - 입출력이 구현되는 곳: 파일 디스크, 키보드, 마우스, 네트웍, 메모리 등 모든 자료가 입력되고 출력되는 곳

    - 대상 기준 : 입력 스트림 / 출력 스트림
        - 입력 스트림 : 대상으로부터 자료를 읽어 들이는 스트림
            - FileInputStream, FileReader, BufferedInputStream, BufferedReader 등
        - 출력 스트림 : 대상으로 자료를 출력하는 스트림
            - FileOutputStream, FileWriter, BufferedOutputStream, BufferedWriter 등

    - 자료의 종류 : 바이트 스트림 / 문자 스트림
        - 바이트 단위 스트림 : 동영상, 음악 파일, 실행 파일등의 자료를 읽고 쓸 때 사용
            - FileInputStream, FileOutputStream, BufferedInputStream, BufferedOutputStream
        - 문자 단위 스트림 : 바이트 단위로 자료를 처리하면 문자는 깨짐, 인코딩에 맞게 2바이트 이상으로 처리하도록 구현된 스트림
            - FileInputStream, FileOutputStream, BufferedInputStream, BufferedOutputStream

    - 기능 : 기반 스트림 / 보조 스트림
        - 기반 스트림 : 대상에 직접 자료를 읽고 쓰는 기능의 스트림
            - FileInputStream, FileOutputStream, FileReader, FileWriter 
        - 보조 스트림 : 직접 읽고 쓰는 기능은 없이 추가적인 기능을 더해주는 스트림
            - InputStreamReader, OutputStreamWriter, BufferedInputStream, BufferedOutputStream
        - 보조 스트림은 직접 읽고 쓰는 기능은 없으므로 항상 기반 스트림이나 또 다른 보조 스트림을 생성자의 매개 변수로 포함함

    - System 클래스의 표준 입출력 스트림
        - System.out
        - System.in
        - System.err

    - 바이트 단위 입출력 스트림
        - InputStream
            - 바이트 단위 입력 스트림 최상위 추상 클래스
            - 많은 추상 메서드가 선언되어 있고 이를 하위 스트림이 상속받아 구현함
            - 주요 하위 클래스
                - FileInputStream : 파일에서 바이트 단위로 자료를 읽습니다.
                - ByteArrayInputStream : byte 배열 메모리에서 바이트 단위로 자료를 읽습니다.
                - FilterInputStream : 기반 스트림에서 자료를 읽을 때 추가 기능을 제공하는 보조 스트림의 상위 클래스
        - OutputStream
            - 바이트 단위 출력 스트림 최상위 추상 클래스
            - 많은 추상 메서드가 선언되어 있고 이를 하위 스트림이 상속받아 구현함
            - 주요 하위 클래스
                - FileOutputStream
                - ByteArrayOutputStream
                - FilterOutputStream
            - flush() 와 close() 메서드
                - 출력 버퍼를 비울때 flush() 메서드를 사용
                - close() 메서드 내부에서 flush()가 호출되므로 close()메서드가 호출되면 출력 버퍼가 비워짐
    
    - 문자 단위 입출력 스트림
        - Reader
            - 문자 단위 입력 스트림 최상위 추상 클래스
            - 많은 추상 메서드가 선언되어 있고 이를 하위 스트림이 상속받아 구현함
            - 주요 하위 클래스
                - FileReader : 파일에서 문자 단위로 읽는 스트림 클래스입니다.
                - InputStreamReader : 바이트 단위로 읽은 자료를 문자로 변환해주는 보조 스트림 클래스 입니다.
                - BufferedReader : 문자로 읽을 때 배열을 제공하여 한꺼번에 읽을 수 있는 기능을 제공하는 보조 스트림입니다.

        - Writer
            - 문자 단위 출력 스트림 최상위 추상 클래스
            - 많은 추상 메서드가 선언되어 있고 이를 하위 스트림이 상속받아 구현함
            - 주요 하위 클래스
                - FileWriter : 파일에서 문자 단위로 출력하는 스트림 클래스입니다.
                - OutputStreamWriter: 바이트 단위의 자료를 문자로 변환해 출력해주는 보조 스트림 클래스 입니다.
                - BufferedWriter : 문자로 쓸 때 배열을 제공하여 한꺼번에 쓸 수 있는 기능을 제공하는 보조 스트림입니다.
    
    - 보조 스트림
        - 실제 읽고 쓰는 스트림이 아닌 보조 기능을 제공하는 스트림
        - FilterInputStream과 FilterOutputStream이 보조 스트림의 상위 클래스들
        - 생성자의 매개변수로 또 다른 스트림(기반 스트림이나 다른 보조 스트림)을 가짐
        - Decorator Pattern으로 구현 됨
        - 상위 클래스 생성자
        - FilterInputStream과(InputStream in)
        - FilterOutputStream(OutputStream out)
        - BufferedInputStream과 BufferedOutputStream
            - 약 8k의 배열이 제공되어 입출력이 빠르게 하는 기능이 제공되는 보조 스트림
            - BufferedReader와 BufferedWriter는 문자용 입출력 보조 스트림
        - DataInputStream과 DataOutputStream
            - 자료가 메모리에 저장된 상태 그대로 읽거나 쓰는 스트림

- 직렬화 (serialization)
    - 인스턴스의 상태를 그대로 파일 저장하거나 네트웍으로 전송하고 (serialization) 이를 다시 복원(deserializatio) 하는 방식
    - 자바에서는 보조 스트림을 활용하여 직렬화를 제공함
    - ObjectInputStream : InputStream을 생성자의 매개변수로 받아 ObjectInputStream을 생성합니다.
    - ObjectOutputStream : OutputStream을 생성자의 매개변수로 받아 ObjectOutputStream을 생성합니다.
    - Serializable 인터페이스
        - 직렬화는 인스턴스의 내용이 외부로 유출되는 것이므로 프로그래머가 해당 객체에 대한 직렬화 의도를 표시해야 함
        - 구현 코드가 없는 marker interface
        - transient : 직렬화 하지 않으려는 멤버 변수에 사용함 (Socket등 직렬화 할 수 없는 객체)
    - Externalizable 인터페이스
        - writerExternal()과 readExternal()메서드를 구현해야 함
        - 프로그래머가 직접 객체를 읽고 쓰는 코드를 구현 할 수 있음

- 여러가지 입출력 클래스들
    - File 클래스
        - 파일 개념을 추상화한 클래스
        - 입출력 기능은 없고, 파일의 이름, 경로, 읽기 전용등의 속성을 알수 있음
        - 이를 지원하는 여러 메서드들이 제공됨
    - RandomAccessFile 클래스
        - 입출력 클래스 중 유일하게 파일에 대한 입력과 출력을 동시에 할 수 있는 클래스
        - 파일 포인터가 있어서 읽고 쓰는 위치의 이동이 가능함
        - 다양한 메서드가 제공됨
